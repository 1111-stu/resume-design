import{a as t,j as e,d as o,e as l,c as a,f as s,g as i,k as n,i as r,o as p,s as m}from"./element-plus.73e44ac8.js";import{d as u,e as c,o as x,c as d,p as f,Y as v,a as h,y as S,_ as g,X as E,A as T,u as C,a4 as F,W as _,t as I,F as N,j as y,Q as O,ak as b,f as W,x as z,Z as L,z as j,n as R,q as B,B as D,C as k}from"./@vue.2f07ec52.js";import{_ as w,P as A}from"./PreviewImage.6808533b.js";import{_ as M,a as P,u as J,b as U,c as V,d as G,p as K,T as X}from"./index.68f9abb8.js";import{h as H}from"./moment.17f8281e.js";import{d as Y}from"./vuedraggable.7f0566f4.js";import{l as $}from"./lodash.9a4b4219.js";import{h as q}from"./html2canvas.c4a43e03.js";import{J as Z}from"./jspdf.1d58ee56.js";import{s as Q}from"./pinia.144cc524.js";import{u as tt,b as et}from"./vue-router.1fa85672.js";import{d as ot}from"./c-scrollbar.409fc4e1.js";import{F as lt}from"./file-saver.f3c21b7d.js";import{s as at}from"./vue3-pdfjs.21d748aa.js";import"./lodash-es.032e1c7e.js";import"./@vueuse.7ecd16a9.js";import"./@element-plus.21c32065.js";import"./@popperjs.36402333.js";import"./@ctrl.82a509e0.js";import"./dayjs.0371a6c7.js";import"./async-validator.ed4c92a2.js";import"./memoize-one.4ee5c96d.js";import"./escape-html.e5dfadb9.js";import"./normalize-wheel-es.1c4ac15a.js";import"./@floating-ui.1ef3caef.js";import"./vue-uuid.5db441ec.js";import"./colorpicker-v3.9786f840.js";import"./pdfjs-dist.207706dd.js";import"./dommatrix.4ee1d507.js";import"./web-streams-polyfill.e202f7fa.js";import"./vue.c7f6a9e2.js";import"./sortablejs.fbe5cdec.js";var st=M(u({props:{title:{default:"模块选择"}},emits:["unflodOrCollapse"],setup(e,{emit:o}){const l=c("收起"),a=c(!0),s=c(null),i=()=>{a.value?(l.value="展开",a.value=!1,s.value.style.transform="rotate(180deg)"):(l.value="收起",a.value=!0,s.value.style.transform="rotate(0deg)"),o("unflodOrCollapse",a.value)};return(o,n)=>{const r=P,p=t;return x(),d("div",{class:T(["title",{"collapse-center":!a.value}])},[f(h("h1",null,S(e.title),513),[[v,a.value]]),g(p,{class:"box-item",effect:"dark",content:l.value},{default:E((()=>[h("div",{class:"unfold-collapse-box",onClick:i,ref_key:"switchRef",ref:s},[g(r,{iconName:"icon-shouqi",color:"#00c091",size:"24px"})],512)])),_:1},8,["content"])],2)}}}),[["__scopeId","data-v-7e391139"]]);const it={class:"model-list-box"},nt={class:"model-ul"},rt=["onClick"],pt={class:"left"},mt={class:"right"};var ut=M(u({props:{leftShowStatus:null},setup(t){const{resumeJsonStore:o}=J(),l=U(),a=()=>{},s=()=>{};return(i,n)=>{const r=P,p=e;return x(),d("div",it,[h("div",nt,[g(C(Y),{list:C(o).LIST,itemKey:"id","ghost-class":"ghost","chosen-class":"chosenClass",animation:"300",onStart:a,onEnd:s},{item:E((({element:e,index:a})=>[h("div",{class:T(["model-list-item",{active:C(l).id===e.id},{"collapse-center":!t.leftShowStatus}]),onClick:t=>(t=>{let e=V(`${o.NAME}-${t.model}`),a={model:t.model,optionsName:e,title:t.title,id:t.id};l.setResumeModel(a)})(e)},[h("div",pt,[h("div",{class:T(["icon-box",{"collapse-size":!t.leftShowStatus}])},[g(r,{iconName:e.iconfont,className:"icon",color:t.leftShowStatus?"#c4c4c4":"#00c091",size:"16px"},null,8,["iconName","color"])],2),f(h("p",null,S(e.title),513),[[v,t.leftShowStatus]])]),f(h("div",mt,[g(p,{modelValue:e.show,"onUpdate:modelValue":t=>e.show=t,size:"small","active-color":"#00C091"},null,8,["modelValue","onUpdate:modelValue"])],512),[[v,t.leftShowStatus]])],10,rt)])),_:1},8,["list"])])])}}}),[["__scopeId","data-v-4e6c8d76"]]);var ct=M(u({setup(t){const{resumeJsonStore:e}=J(),n=G(),r=K(e.MODEL_MARGIN_TOP),p=c(r),m=t=>{e.MODEL_MARGIN_TOP=t+"px",e.LIST.forEach((t=>{t.style.mTop=e.MODEL_MARGIN_TOP}))},u=K(e.MODEL_MARGIN_BOTTOM),f=c(u),v=t=>{e.MODEL_MARGIN_BOTTOM=t+"px",e.LIST.forEach((t=>{t.style.mBottom=e.MODEL_MARGIN_BOTTOM}))};return(t,r)=>{const u=o,c=l,h=a,S=F("color-picker"),T=s,y=i;return x(),_(y,{"label-width":"100px","label-position":"left"},{default:E((()=>[g(h,{label:"标题字体大小:"},{default:E((()=>[g(c,{modelValue:C(e).TITLE_FONT_SIZE,"onUpdate:modelValue":r[0]||(r[0]=t=>C(e).TITLE_FONT_SIZE=t),class:"m-2",placeholder:"Select"},{default:E((()=>[(x(!0),d(N,null,I(C(n),((t,e)=>(x(),_(u,{key:e,label:t,value:t},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),g(h,{label:"标题字体颜色:"},{default:E((()=>[g(S,{rgba:C(e).TITLE_COLOR,"onUpdate:rgba":r[1]||(r[1]=t=>C(e).TITLE_COLOR=t)},null,8,["rgba"])])),_:1}),g(h,{label:"模块上外边距:"},{default:E((()=>[g(T,{modelValue:p.value,"onUpdate:modelValue":r[2]||(r[2]=t=>p.value=t),min:-100,max:100,onChange:m},null,8,["modelValue"])])),_:1}),g(h,{label:"模块下外边距:"},{default:E((()=>[g(T,{modelValue:f.value,"onUpdate:modelValue":r[3]||(r[3]=t=>f.value=t),min:-100,max:100,onChange:v},null,8,["modelValue"])])),_:1})])),_:1})}}}),[["__scopeId","data-v-b243ada4"]]);let xt={template1:{RESUME_TITLE:{textColor:"#fff",textFontSize:"16px",textFontWeight:600,backgroundColor:"#000",mBottom:"35px",mTop:"15px"},BASE_INFO:{titleColor:"#121c26",titleFontSize:"30px",textFontSize:"14px",titleFontWeight:500,textFontWeight:500,textColor:"#7c7b7b",mBottom:"50px",mTop:"0px"},JOB_INTENTION:{textColor:"#757575",textFontSize:"14px",textFontWeight:500,mBottom:"35px",mTop:"0px"},EDU_BACKGROUND:{textColor:"#666",textFontSize:"14px",textFontWeight:600,mBottom:"35px",mTop:"0px"},SKILL_SPECIALTIES:{textColor:"#757575",textFontSize:"14px",textFontWeight:500,mBottom:"35px",mTop:"0px"},CAMPUS_EXPERIENCE:{titleColor:"#666",titleFontSize:"14px",titleFontWeight:600,textColor:"#757575",textFontSize:"14px",textFontWeight:500,mBottom:"35px",mTop:"0px"},INTERNSHIP_EXPERIENCE:{titleColor:"#666",titleFontSize:"14px",titleFontWeight:600,textColor:"#757575",textFontSize:"14px",textFontWeight:500,mBottom:"35px",mTop:"0px"},WORK_EXPERIENCE:{titleColor:"#666",titleFontSize:"14px",titleFontWeight:600,textColor:"#757575",textFontSize:"14px",textFontWeight:500,mBottom:"35px",mTop:"0px"},PROJECT_EXPERIENCE:{titleColor:"#666",titleFontSize:"14px",titleFontWeight:600,textColor:"#757575",textFontSize:"14px",textFontWeight:500,mBottom:"35px",mTop:"0px"},AWARDS:{textColor:"#757575",textFontSize:"14px",textFontWeight:500,mBottom:"35px",mTop:"0px"},SELF_EVALUATION:{textColor:"#757575",textFontSize:"14px",textFontWeight:500,mBottom:"35px",mTop:"0px"},WORKS_DISPLAY:{textColor:"#757575",textFontSize:"14px",textFontWeight:500,mBottom:"35px",mTop:"0px"}},template2:{RESUME_TITLE:{textColor:"#fff",textFontSize:"16px",textFontWeight:600,backgroundColor:"#000",mBottom:"35px",mTop:"15px"},BASE_INFO:{titleColor:"#121c26",titleFontSize:"30px",textFontSize:"14px",titleFontWeight:500,textFontWeight:500,textColor:"#fff",mBottom:"50px",mTop:"0px"},JOB_INTENTION:{textColor:"#757575",textFontSize:"14px",textFontWeight:500,mBottom:"35px",mTop:"0px"},EDU_BACKGROUND:{textColor:"#757575",textFontSize:"14px",textFontWeight:500,titleColor:"#666666",titleFontSize:"14px",titleFontWeight:600,mBottom:"35px",mTop:"0px"},SKILL_SPECIALTIES:{textColor:"#fff",textFontSize:"14px",textFontWeight:500,mBottom:"35px",mTop:"0px"},CAMPUS_EXPERIENCE:{titleColor:"#666",titleFontSize:"14px",titleFontWeight:600,textColor:"#757575",textFontSize:"14px",textFontWeight:500,mBottom:"35px",mTop:"0px"},INTERNSHIP_EXPERIENCE:{titleColor:"#666",titleFontSize:"14px",titleFontWeight:600,textColor:"#757575",textFontSize:"14px",textFontWeight:500,mBottom:"35px",mTop:"0px"},WORK_EXPERIENCE:{titleColor:"#666",titleFontSize:"14px",titleFontWeight:600,textColor:"#757575",textFontSize:"14px",textFontWeight:500,mBottom:"35px",mTop:"0px"},PROJECT_EXPERIENCE:{titleColor:"#666",titleFontSize:"14px",titleFontWeight:600,textColor:"#757575",textFontSize:"14px",textFontWeight:500,mBottom:"35px",mTop:"0px"},AWARDS:{textColor:"#757575",textFontSize:"14px",textFontWeight:500,titleColor:"#666666",titleFontSize:"14px",titleFontWeight:600,mBottom:"35px",mTop:"0px"},SELF_EVALUATION:{textColor:"#757575",textFontSize:"14px",textFontWeight:500,mBottom:"35px",mTop:"0px"},WORKS_DISPLAY:{textColor:"#757575",textFontSize:"14px",textFontWeight:500,mBottom:"35px",mTop:"0px"}}};const dt=t=>(D("data-v-57f7af2b"),t=t(),k(),t),ft={class:"design-box"},vt={class:"nav-box"},ht={class:"nav-center"},St={class:"draft-tips"},gt={class:"nav-right"},Et=z("全局样式设置"),Tt=z("保存草稿"),Ct=z("导出PDF"),Ft=z("导出JSON数据"),_t=z("重置"),It={class:"bottom"},Nt={class:"center"},yt=dt((()=>h("p",{class:"tips"},"如果分割线遮挡内容，请通过调整模块上下边距以显示内容！",-1))),Ot={class:"page"},bt={class:"config"};var Wt=M(u({setup(t){const{title:e}=Q(U()),o=J();let{resumeJsonStore:l}=Q(J());const a=t=>{let e=JSON.parse(JSON.stringify(t));return e.LIST.map(((t,o)=>{t.style||(t.style=xt[l.value.NAME][t.model]),e.LIST[o]=t})),e},s=localStorage.getItem("resumeDraft"),i=tt(),{id:u,name:T}=i.query;l.value.ID=u,l.value.NAME=T;const D=c(T);if(s){let t=JSON.parse(s)[u];if(t)t=a(t),o.changeResumeJsonData(t);else{X.ID=u,X.NAME=T;let t=a(X);o.changeResumeJsonData(t)}}else{X.ID=u,X.NAME=T;let t=a(X);o.changeResumeJsonData(t)}if(2==Number(u)){let t=[];l.value.LIST.forEach((e=>{"RESUME_TITLE"==e.model&&(e.show=!1),t.push(e)})),l.value.LIST=t}const k=et(),M=()=>{k.push({path:"/"})},P=c(null),V=c(!1),G=()=>{V.value=!0,P.value.focus()},K=()=>{V.value=!1};y((async()=>{Jt(),Vt()})),O((()=>{null==At||At.disconnect()})),b((()=>{Wt=[]}));let Y=c("");const it=()=>{let t=l.value.ID,e={},o=localStorage.getItem("resumeDraft");o?(e=JSON.parse(o),e[t]=l.value):e[t]=l.value,localStorage.setItem("resumeDraft",JSON.stringify(e));const a=H(new Date).format("YYYY.MM.DD HH:mm:ss");Y.value=`已自动保存草稿  ${a}`},nt=$.exports.debounce((()=>{it()}),1e3);W(l.value,(()=>{nt()}),{deep:!0});const rt=U(),pt=()=>{localStorage.clear(),rt.$reset()},mt=()=>{it()},dt=c(null);let Wt=[];const zt=()=>{let t=a(X);o.changeResumeJsonData(t);let e=localStorage.getItem("resumeDraft");if(e){let t=JSON.parse(e);Object.keys(t).length>1?t[u]&&(delete t[u],localStorage.setItem("resumeDraft",JSON.stringify(t))):localStorage.removeItem("resumeDraft")}location.reload()},Lt=async()=>{let t=Pt.value;Pt.value=0,rt.$reset(),await R(),((t,e,o,l)=>{let a=t.offsetWidth,s=t.offsetHeight,i=t.offsetTop,n=t.offsetLeft,r=document.createElement("canvas"),p=0,m=document.documentElement.clientWidth||document.body.clientWidth,u=window.innerWidth;u>m&&(p=(u-m)/2),r.width=2*a,r.height=2*s;let c=r.getContext("2d");c.scale(2,2),c.translate(-n-p,-i),q(t,{scale:2,useCORS:!0,logging:!1}).then((t=>{let a=t.width,s=t.height,i=a/592.28*841.89,n=s,r=0,p=595.28,m=595.28/a*s,u=t.toDataURL("image/jpeg",1),c=new Z("","pt","a4");if(n<i)c.addImage(u,"JPEG",0,0,p,m);else for(;n>0;)c.addImage(u,"JPEG",0,r,p,m),n-=i,r-=841.89,n>0&&c.addPage();if(o){let t=c.output("datauristring");l(t)}else c.save(e),l()}))})(dt.value,l.value.TITLE,!1,(()=>{Pt.value=t}))},jt=()=>{const t=JSON.stringify(l.value),e=new Blob([t],{type:""});lt.saveAs(e,l.value.TITLE)},Rt=c(""),Bt=c(0),Dt=c(!1),kt=()=>{Dt.value=!1},wt=c(null);let At=null,Mt=0,Pt=c(0);const Jt=()=>{At=new ResizeObserver((async t=>{for(let e of t)Mt=e.target.offsetHeight,Pt.value=Math.ceil(Mt/1160),dt.value.style.height=1160*Pt.value+"px",wt.value.style.height=dt.value.style.height})),At.observe(wt.value)},Ut=t=>{wt.value.style.height=t+"px"},Vt=()=>{window.addEventListener("click",Gt)},Gt=t=>{Kt(wt.value,t.target)&&pt()},Kt=(t,e)=>!(!t||t===document)&&(t===e||Kt(t.parentNode,e));O((()=>{window.removeEventListener("click",Gt)}));const Xt=c(null),Ht=c(!0),Yt=t=>{t?(setTimeout((()=>{Ht.value=t}),100),Xt.value.style.width="300px"):(setTimeout((()=>{Ht.value=t}),100),Xt.value.style.width="70px")};return(t,o)=>{const a=F("Edit"),s=n,i=r,u=p,c=m;return x(),d(N,null,[h("div",ft,[h("nav",vt,[h("div",{class:"nav-left"},[h("img",{src:w,alt:"logo",srcset:"",onClick:M}),h("span",{onClick:M},"化简")]),h("div",ht,[h("span",St,S(C(Y)),1),f(h("p",null,[z(S(C(l).TITLE)+" ",1),g(s,{size:20,color:"#409eff",onClick:G},{default:E((()=>[g(a)])),_:1})],512),[[v,!V.value]]),f(g(i,{ref_key:"titleIpf",ref:P,modelValue:C(l).TITLE,"onUpdate:modelValue":o[0]||(o[0]=t=>C(l).TITLE=t),autofocus:"",placeholder:"请输入标题",onBlur:K},null,8,["modelValue"]),[[v,V.value]])]),h("div",gt,[g(u,{type:"primary",onClick:pt},{default:E((()=>[Et])),_:1}),g(u,{type:"primary",onClick:mt},{default:E((()=>[Tt])),_:1}),g(u,{type:"primary",onClick:Lt},{default:E((()=>[Ct])),_:1}),g(u,{type:"primary",onClick:jt},{default:E((()=>[Ft])),_:1}),g(c,{title:"重置会删除所有已编辑内容，是否继续?",onConfirm:zt,confirmButtonText:"确定",cancelButtonText:"取消"},{reference:E((()=>[g(u,{type:"primary"},{default:E((()=>[_t])),_:1})])),_:1})])]),h("div",It,[h("div",{class:"left",ref_key:"leftRef",ref:Xt},[g(C(ot.exports.CScrollbar),{trigger:"hover",hThumbStyle:{"background-color":"rgba(0,0,0,0.4)"}},{default:E((()=>[g(st,{onUnflodOrCollapse:Yt}),g(ut,{leftShowStatus:Ht.value},null,8,["leftShowStatus"])])),_:1},8,["hThumbStyle"])],512),h("div",Nt,[h("div",{class:"design",ref_key:"html2Pdf",ref:dt},[h("div",{class:"design-content",ref_key:"htmlContentPdf",ref:wt},[(x(),_(L(D.value),{onContentHeightChange:Ut}))],512),C(Pt)>0?(x(!0),d(N,{key:0},I(C(Pt),((t,e)=>(x(),d("div",{class:"lines",ref_for:!0,ref:t=>((t,e)=>{t&&(Pt.value===e+1&&(t.style.top=1160*Pt.value+"px"),Wt.push(t))})(t,e),style:B({top:1128+1132*e+"px"})},[yt,h("p",Ot,S(e+1)+"/"+S(C(Pt)),1)],4)))),256)):j("",!0)],512)]),h("div",bt,[g(st,{title:C(e)},null,8,["title"]),C(rt).model?(x(),_(L(C(rt).optionsName),{key:C(rt).id})):(x(),_(ct,{key:1}))])])]),f(g(A,{onClose:kt},{default:E((()=>[(x(!0),d(N,null,I(Bt.value,(t=>(x(),_(C(at),{key:t,src:Rt.value,page:t,scale:.5},null,8,["src","page","scale"])))),128))])),_:1},512),[[v,Dt.value]])],64)}}}),[["__scopeId","data-v-57f7af2b"]]);export{Wt as default};
