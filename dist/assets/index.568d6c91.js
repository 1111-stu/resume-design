import{a as t,j as e,d as o,e as l,c as a,f as s,g as i,k as n,i as r,o as p,s as m}from"./element-plus.54af6ecb.js";import{d as u,e as c,o as x,c as d,m as f,Y as h,a as v,x as S,W as g,X as E,_ as T,y as C,z as F,u as _,a4 as I,q as b,F as y,j as N,Q as O,ak as W,f as z,t as L,Z as j,n as R,p as B,A as w,B as k}from"./@vue.400cde23.js";import{_ as D,P as A}from"./PreviewImage.35c3489d.js";import{_ as M,a as P,u as J,b as U,c as V,d as G,p as K,T as X}from"./index.bdf57119.js";import{h as H}from"./moment.17f8281e.js";import{d as Y}from"./vuedraggable.9e9ac958.js";import{l as $}from"./lodash.e0473d21.js";import{h as q}from"./html2canvas.c4a43e03.js";import{J as Z}from"./jspdf.76187c9d.js";import{s as Q}from"./pinia.6cef6b80.js";import{u as tt,b as et}from"./vue-router.a9498a4b.js";import{d as ot}from"./c-scrollbar.f0ced9d1.js";import{F as lt}from"./file-saver.b1d07b47.js";import{s as at}from"./vue3-pdfjs.374215a3.js";import"./lodash-es.032e1c7e.js";import"./@vueuse.4dc5a6bb.js";import"./@element-plus.0246fa1f.js";import"./@popperjs.36402333.js";import"./@ctrl.82a509e0.js";import"./dayjs.cda24304.js";import"./async-validator.ed4c92a2.js";import"./memoize-one.4ee5c96d.js";import"./escape-html.e5dfadb9.js";import"./normalize-wheel-es.1c4ac15a.js";import"./@floating-ui.1ef3caef.js";import"./vue-uuid.5db441ec.js";import"./colorpicker-v3.adcecff5.js";import"./pdfjs-dist.6f40ee22.js";import"./dommatrix.874402ab.js";import"./web-streams-polyfill.5471c177.js";import"./vue.0ab873a3.js";import"./sortablejs.4530746f.js";var st=M(u({props:{title:{default:"模块选择"},showCollapse:{type:Boolean}},emits:["unflodOrCollapse"],setup(e,{emit:o}){const l=c("收起"),a=c(!0),s=c(null),i=()=>{a.value?(l.value="展开",a.value=!1,s.value.style.transform="rotate(180deg)"):(l.value="收起",a.value=!0,s.value.style.transform="rotate(0deg)"),o("unflodOrCollapse",a.value)};return(o,n)=>{const r=P,p=t;return x(),d("div",{class:F(["title",{"collapse-center":!a.value}])},[f(v("h1",null,S(e.title),513),[[h,a.value]]),e.showCollapse?(x(),g(p,{key:0,class:"box-item",effect:"dark",content:l.value},{default:E((()=>[v("div",{class:"unfold-collapse-box",onClick:i,ref_key:"switchRef",ref:s},[T(r,{iconName:"icon-shouqi",color:"#00c091",size:"24px"})],512)])),_:1},8,["content"])):C("",!0)],2)}}}),[["__scopeId","data-v-209274e6"]]);const it={class:"model-list-box"},nt={class:"model-ul"},rt=["onClick"],pt={class:"left"},mt={class:"right"};var ut=M(u({props:{leftShowStatus:null},setup(o){const{resumeJsonStore:l}=J(),a=U(),s=()=>{},i=()=>{};return(n,r)=>{const p=P,m=t,u=e;return x(),d("div",it,[v("div",nt,[T(_(Y),{list:_(l).LIST,itemKey:"id","ghost-class":"ghost","chosen-class":"chosenClass",animation:"300",onStart:s,onEnd:i},{item:E((({element:t,index:e})=>[v("div",{class:F(["model-list-item",{active:_(a).id===t.id},{"collapse-center":!o.leftShowStatus}]),onClick:e=>(t=>{let e=V(`${l.NAME}-${t.model}`),o={model:t.model,optionsName:e,title:t.title,id:t.id};a.setResumeModel(o)})(t)},[v("div",pt,[v("div",{class:F(["icon-box",{"collapse-size":!o.leftShowStatus}])},[T(m,{class:"box-item",placement:"right",effect:"dark",content:t.title,disabled:o.leftShowStatus},{default:E((()=>[T(p,{iconName:t.iconfont,className:"icon",color:o.leftShowStatus?"#c4c4c4":"#00c091",size:"16px"},null,8,["iconName","color"])])),_:2},1032,["content","disabled"])],2),f(v("p",null,S(t.title),513),[[h,o.leftShowStatus]])]),f(v("div",mt,[T(u,{modelValue:t.show,"onUpdate:modelValue":e=>t.show=e,size:"small","active-color":"#00C091"},null,8,["modelValue","onUpdate:modelValue"])],512),[[h,o.leftShowStatus]])],10,rt)])),_:1},8,["list"])])])}}}),[["__scopeId","data-v-c6fe2cfc"]]);var ct=M(u({setup(t){const{resumeJsonStore:e}=J(),n=G(),r=K(e.MODEL_MARGIN_TOP),p=c(r),m=t=>{e.MODEL_MARGIN_TOP=t+"px",e.LIST.forEach((t=>{t.style.mTop=e.MODEL_MARGIN_TOP}))},u=K(e.MODEL_MARGIN_BOTTOM),f=c(u),h=t=>{e.MODEL_MARGIN_BOTTOM=t+"px",e.LIST.forEach((t=>{t.style.mBottom=e.MODEL_MARGIN_BOTTOM}))};return(t,r)=>{const u=o,c=l,v=a,S=I("color-picker"),C=s,F=i;return x(),g(F,{"label-width":"100px","label-position":"left"},{default:E((()=>[T(v,{label:"标题字体大小:"},{default:E((()=>[T(c,{modelValue:_(e).TITLE_FONT_SIZE,"onUpdate:modelValue":r[0]||(r[0]=t=>_(e).TITLE_FONT_SIZE=t),class:"m-2",placeholder:"Select"},{default:E((()=>[(x(!0),d(y,null,b(_(n),((t,e)=>(x(),g(u,{key:e,label:t,value:t},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),T(v,{label:"标题字体颜色:"},{default:E((()=>[T(S,{rgba:_(e).TITLE_COLOR,"onUpdate:rgba":r[1]||(r[1]=t=>_(e).TITLE_COLOR=t)},null,8,["rgba"])])),_:1}),T(v,{label:"模块上外边距:"},{default:E((()=>[T(C,{modelValue:p.value,"onUpdate:modelValue":r[2]||(r[2]=t=>p.value=t),min:-100,max:100,onChange:m},null,8,["modelValue"])])),_:1}),T(v,{label:"模块下外边距:"},{default:E((()=>[T(C,{modelValue:f.value,"onUpdate:modelValue":r[3]||(r[3]=t=>f.value=t),min:-100,max:100,onChange:h},null,8,["modelValue"])])),_:1})])),_:1})}}}),[["__scopeId","data-v-b243ada4"]]);let xt={template1:{RESUME_TITLE:{textColor:"#fff",textFontSize:"16px",textFontWeight:600,backgroundColor:"#000",mBottom:"35px",mTop:"15px"},BASE_INFO:{titleColor:"#121c26",titleFontSize:"30px",textFontSize:"14px",titleFontWeight:500,textFontWeight:500,textColor:"#7c7b7b",mBottom:"50px",mTop:"0px"},JOB_INTENTION:{textColor:"#757575",textFontSize:"14px",textFontWeight:500,mBottom:"35px",mTop:"0px"},EDU_BACKGROUND:{textColor:"#666",textFontSize:"14px",textFontWeight:600,mBottom:"35px",mTop:"0px"},SKILL_SPECIALTIES:{textColor:"#757575",textFontSize:"14px",textFontWeight:500,mBottom:"35px",mTop:"0px"},CAMPUS_EXPERIENCE:{titleColor:"#666",titleFontSize:"14px",titleFontWeight:600,textColor:"#757575",textFontSize:"14px",textFontWeight:500,mBottom:"35px",mTop:"0px"},INTERNSHIP_EXPERIENCE:{titleColor:"#666",titleFontSize:"14px",titleFontWeight:600,textColor:"#757575",textFontSize:"14px",textFontWeight:500,mBottom:"35px",mTop:"0px"},WORK_EXPERIENCE:{titleColor:"#666",titleFontSize:"14px",titleFontWeight:600,textColor:"#757575",textFontSize:"14px",textFontWeight:500,mBottom:"35px",mTop:"0px"},PROJECT_EXPERIENCE:{titleColor:"#666",titleFontSize:"14px",titleFontWeight:600,textColor:"#757575",textFontSize:"14px",textFontWeight:500,mBottom:"35px",mTop:"0px"},AWARDS:{textColor:"#757575",textFontSize:"14px",textFontWeight:500,mBottom:"35px",mTop:"0px"},SELF_EVALUATION:{textColor:"#757575",textFontSize:"14px",textFontWeight:500,mBottom:"35px",mTop:"0px"},WORKS_DISPLAY:{textColor:"#757575",textFontSize:"14px",textFontWeight:500,mBottom:"35px",mTop:"0px"}},template2:{RESUME_TITLE:{textColor:"#fff",textFontSize:"16px",textFontWeight:600,backgroundColor:"#000",mBottom:"35px",mTop:"15px"},BASE_INFO:{titleColor:"#121c26",titleFontSize:"30px",textFontSize:"14px",titleFontWeight:500,textFontWeight:500,textColor:"#fff",mBottom:"50px",mTop:"0px"},JOB_INTENTION:{textColor:"#757575",textFontSize:"14px",textFontWeight:500,mBottom:"35px",mTop:"0px"},EDU_BACKGROUND:{textColor:"#757575",textFontSize:"14px",textFontWeight:500,titleColor:"#666666",titleFontSize:"14px",titleFontWeight:600,mBottom:"35px",mTop:"0px"},SKILL_SPECIALTIES:{textColor:"#fff",textFontSize:"14px",textFontWeight:500,mBottom:"35px",mTop:"0px"},CAMPUS_EXPERIENCE:{titleColor:"#666",titleFontSize:"14px",titleFontWeight:600,textColor:"#757575",textFontSize:"14px",textFontWeight:500,mBottom:"35px",mTop:"0px"},INTERNSHIP_EXPERIENCE:{titleColor:"#666",titleFontSize:"14px",titleFontWeight:600,textColor:"#757575",textFontSize:"14px",textFontWeight:500,mBottom:"35px",mTop:"0px"},WORK_EXPERIENCE:{titleColor:"#666",titleFontSize:"14px",titleFontWeight:600,textColor:"#757575",textFontSize:"14px",textFontWeight:500,mBottom:"35px",mTop:"0px"},PROJECT_EXPERIENCE:{titleColor:"#666",titleFontSize:"14px",titleFontWeight:600,textColor:"#757575",textFontSize:"14px",textFontWeight:500,mBottom:"35px",mTop:"0px"},AWARDS:{textColor:"#757575",textFontSize:"14px",textFontWeight:500,titleColor:"#666666",titleFontSize:"14px",titleFontWeight:600,mBottom:"35px",mTop:"0px"},SELF_EVALUATION:{textColor:"#757575",textFontSize:"14px",textFontWeight:500,mBottom:"35px",mTop:"0px"},WORKS_DISPLAY:{textColor:"#757575",textFontSize:"14px",textFontWeight:500,mBottom:"35px",mTop:"0px"}}};const dt=t=>(w("data-v-523d9917"),t=t(),k(),t),ft={class:"design-box"},ht={class:"nav-box"},vt={class:"nav-center"},St={class:"draft-tips"},gt={class:"nav-right"},Et=L("全局样式设置"),Tt=L("保存草稿"),Ct=L("导出PDF"),Ft=L("导出JSON数据"),_t=L("重置"),It={class:"bottom"},bt={class:"center"},yt=dt((()=>v("p",{class:"tips"},"如果分割线遮挡内容，请通过调整模块上下边距以显示内容！",-1))),Nt={class:"page"},Ot={class:"config"};var Wt=M(u({setup(t){const{title:e}=Q(U()),o=J();let{resumeJsonStore:l}=Q(J());const a=t=>{let e=JSON.parse(JSON.stringify(t));return e.LIST.map(((t,o)=>{t.style||(t.style=xt[l.value.NAME][t.model]),e.LIST[o]=t})),e},s=localStorage.getItem("resumeDraft"),i=tt(),{id:u,name:F}=i.query;l.value.ID=u,l.value.NAME=F;const w=c(F);if(s){let t=JSON.parse(s)[u];if(t)t=a(t),o.changeResumeJsonData(t);else{X.ID=u,X.NAME=F;let t=a(X);o.changeResumeJsonData(t)}}else{X.ID=u,X.NAME=F;let t=a(X);o.changeResumeJsonData(t)}if(2==Number(u)){let t=[];l.value.LIST.forEach((e=>{"RESUME_TITLE"==e.model&&(e.show=!1),t.push(e)})),l.value.LIST=t}const k=et(),M=()=>{k.push({path:"/"})},P=c(null),V=c(!1),G=()=>{V.value=!0,P.value.focus()},K=()=>{V.value=!1};N((async()=>{Jt(),Vt()})),O((()=>{null==At||At.disconnect()})),W((()=>{Wt=[]}));let Y=c("");const it=()=>{let t=l.value.ID,e={},o=localStorage.getItem("resumeDraft");o?(e=JSON.parse(o),e[t]=l.value):e[t]=l.value,localStorage.setItem("resumeDraft",JSON.stringify(e));const a=H(new Date).format("YYYY.MM.DD HH:mm:ss");Y.value=`已自动保存草稿  ${a}`},nt=$.exports.debounce((()=>{it()}),1e3);z(l.value,(()=>{nt()}),{deep:!0});const rt=U(),pt=()=>{localStorage.clear(),rt.$reset()},mt=()=>{it()},dt=c(null);let Wt=[];const zt=()=>{let t=a(X);o.changeResumeJsonData(t);let e=localStorage.getItem("resumeDraft");if(e){let t=JSON.parse(e);Object.keys(t).length>1?t[u]&&(delete t[u],localStorage.setItem("resumeDraft",JSON.stringify(t))):localStorage.removeItem("resumeDraft")}location.reload()},Lt=async()=>{let t=Pt.value;Pt.value=0,rt.$reset(),await R(),((t,e,o,l)=>{let a=t.offsetWidth,s=t.offsetHeight,i=t.offsetTop,n=t.offsetLeft,r=document.createElement("canvas"),p=0,m=document.documentElement.clientWidth||document.body.clientWidth,u=window.innerWidth;u>m&&(p=(u-m)/2),r.width=2*a,r.height=2*s;let c=r.getContext("2d");c.scale(2,2),c.translate(-n-p,-i),q(t,{scale:2,useCORS:!0,logging:!1}).then((t=>{let a=t.width,s=t.height,i=a/592.28*841.89,n=s,r=0,p=595.28,m=595.28/a*s,u=t.toDataURL("image/jpeg",1),c=new Z("","pt","a4");if(n<i)c.addImage(u,"JPEG",0,0,p,m);else for(;n>0;)c.addImage(u,"JPEG",0,r,p,m),n-=i,r-=841.89,n>0&&c.addPage();if(o){let t=c.output("datauristring");l(t)}else c.save(e),l()}))})(dt.value,l.value.TITLE,!1,(()=>{Pt.value=t}))},jt=()=>{const t=JSON.stringify(l.value),e=new Blob([t],{type:""});lt.saveAs(e,l.value.TITLE)},Rt=c(""),Bt=c(0),wt=c(!1),kt=()=>{wt.value=!1},Dt=c(null);let At=null,Mt=0,Pt=c(0);const Jt=()=>{At=new ResizeObserver((async t=>{for(let e of t)Mt=e.target.offsetHeight,Pt.value=Math.ceil(Mt/1160),dt.value.style.height=1160*Pt.value+"px",Dt.value.style.height=dt.value.style.height})),At.observe(Dt.value)},Ut=t=>{Dt.value.style.height=t+"px"},Vt=()=>{window.addEventListener("click",Gt)},Gt=t=>{Kt(Dt.value,t.target)&&pt()},Kt=(t,e)=>!(!t||t===document)&&(t===e||Kt(t.parentNode,e));O((()=>{window.removeEventListener("click",Gt)}));const Xt=c(null),Ht=c(!0),Yt=t=>{t?(setTimeout((()=>{Ht.value=t}),100),Xt.value.style.width="300px"):(setTimeout((()=>{Ht.value=t}),100),Xt.value.style.width="70px")};return(t,o)=>{const a=I("Edit"),s=n,i=r,u=p,c=m;return x(),d(y,null,[v("div",ft,[v("nav",ht,[v("div",{class:"nav-left"},[v("img",{src:D,alt:"logo",srcset:"",onClick:M}),v("span",{onClick:M},"化简")]),v("div",vt,[v("span",St,S(_(Y)),1),f(v("p",null,[L(S(_(l).TITLE)+" ",1),T(s,{size:20,color:"#409eff",onClick:G},{default:E((()=>[T(a)])),_:1})],512),[[h,!V.value]]),f(T(i,{ref_key:"titleIpf",ref:P,modelValue:_(l).TITLE,"onUpdate:modelValue":o[0]||(o[0]=t=>_(l).TITLE=t),autofocus:"",placeholder:"请输入标题",onBlur:K},null,8,["modelValue"]),[[h,V.value]])]),v("div",gt,[T(u,{type:"primary",onClick:pt},{default:E((()=>[Et])),_:1}),T(u,{type:"primary",onClick:mt},{default:E((()=>[Tt])),_:1}),T(u,{type:"primary",onClick:Lt},{default:E((()=>[Ct])),_:1}),T(u,{type:"primary",onClick:jt},{default:E((()=>[Ft])),_:1}),T(c,{title:"重置会删除所有已编辑内容，是否继续?",onConfirm:zt,confirmButtonText:"确定",cancelButtonText:"取消"},{reference:E((()=>[T(u,{type:"primary"},{default:E((()=>[_t])),_:1})])),_:1})])]),v("div",It,[v("div",{class:"left",ref_key:"leftRef",ref:Xt},[T(_(ot.exports.CScrollbar),{trigger:"hover",hThumbStyle:{"background-color":"rgba(0,0,0,0.4)"}},{default:E((()=>[T(st,{onUnflodOrCollapse:Yt,showCollapse:""}),T(ut,{leftShowStatus:Ht.value},null,8,["leftShowStatus"])])),_:1},8,["hThumbStyle"])],512),v("div",bt,[v("div",{class:"design",ref_key:"html2Pdf",ref:dt},[v("div",{class:"design-content",ref_key:"htmlContentPdf",ref:Dt},[(x(),g(j(w.value),{onContentHeightChange:Ut}))],512),_(Pt)>0?(x(!0),d(y,{key:0},b(_(Pt),((t,e)=>(x(),d("div",{class:"lines",ref_for:!0,ref:t=>((t,e)=>{t&&(Pt.value===e+1&&(t.style.top=1160*Pt.value+"px"),Wt.push(t))})(t,e),style:B({top:1128+1132*e+"px"})},[yt,v("p",Nt,S(e+1)+"/"+S(_(Pt)),1)],4)))),256)):C("",!0)],512)]),v("div",Ot,[T(st,{title:_(e)},null,8,["title"]),_(rt).model?(x(),g(j(_(rt).optionsName),{key:_(rt).id})):(x(),g(ct,{key:1}))])])]),f(T(A,{onClose:kt},{default:E((()=>[(x(!0),d(y,null,b(Bt.value,(t=>(x(),g(_(at),{key:t,src:Rt.value,page:t,scale:.5},null,8,["src","page","scale"])))),128))])),_:1},512),[[h,wt.value]])],64)}}}),[["__scopeId","data-v-523d9917"]]);export{Wt as default};
